/**
 * @file file.h
 * @brief Този файл декларира функции за обработка на постоянно съхранение и възстановяване на данни.
 *
 * Той предоставя функционалности за записване и зареждане на данни за имоти от двоични файлове,
 * записване на данни в удобни за потребителя текстови файлове, управление на синхронизацията с файлове за възстановяване,
 * и обработка на потвърждение за презаписване на съществуващи файлове.
 */

#ifndef FILE_H
#define FILE_H

#include "structs.h" 

/**
 * @brief Записва текущия масив от имоти в двоичен файл.
 * @param properties Постоянен масив от структури Property за запис.
 * @param propertyCount Броят на имотите в масива.
 *
 * Тази функция сериализира данни за имоти в двоичен формат за ефективно съхранение
 * и извличане, обикновено използвано за основния файл с данни.
 */
void saveToBinaryFile(const Property properties[], int propertyCount);

/**
 * @brief Зарежда имоти от двоичен файл в паметта на приложението.
 * @param properties Масив от структури Property, където ще бъдат съхранени заредените данни.
 * @param propertyCount Референция към цяло число, което ще съхранява броя на заредените имоти.
 *
 * Десериализира данни за имоти от двоичен файл, попълвайки масива `properties`
 * и актуализирайки `propertyCount`. Това обикновено се извиква при стартиране на приложението.
 */
void loadFromBinaryFile(Property properties[], int& propertyCount);

/**
 * @brief Записва текущия масив от имоти в двоичен файл за възстановяване.
 * @param properties Постоянен масив от структури Property за запис.
 * @param propertyCount Броят на имотите в масива.
 *
 * Тази функция създава резервно копие на данните за имоти в двоичен формат,
 * което може да се използва за възстановяване на данни в случай на неочаквано прекратяване на приложението
 * или повреда на данните.
 */
void saveToRecoveryBinaryFile(const Property properties[], int propertyCount);

/**
 * @brief Записва текущия масив от имоти в четим текстов файл.
 * @param properties Постоянен масив от структури Property за запис.
 * @param propertyCount Броят на имотите в масива.
 *
 * Тази функция експортира данни за имоти във форматиран текстов файл, което го прави
 * лесен за потребителите да преглеждат или споделят данните извън приложението.
 */
void saveToUserFriendlyTextFile(const Property properties[], int propertyCount);

/**
 * @brief Записва текущия масив от имоти в обикновен текстов файл за цели на синхронизация.
 * @param properties Постоянен масив от структури Property за запис.
 * @param propertyCount Броят на имотите в масива.
 *
 * Този файлов формат обикновено е по-опростен от удобния за потребителя и може да бъде оптимизиран
 * за програмно анализиране по време на процесите на синхронизация на данни.
 */
void saveToSyncTextFile(const Property properties[], int propertyCount);

/**
 * @brief Зарежда имоти от обикновен текстов файл за синхронизация в паметта на приложението.
 * @param properties Масив от структури Property, където ще бъдат съхранени заредените данни.
 * @param propertyCount Референция към цяло число, което ще съхранява броя на заредените имоти.
 *
 * Използва се за импортиране на данни за имоти от текстов файл за синхронизация, анализиране на съдържанието му
 * и актуализиране на списъка с имоти в паметта.
 */
void loadFromSyncTextFile(Property properties[], int& propertyCount);

/**
 * @brief Подканва потребителя за потвърждение преди презаписване на съществуващ файл.
 * @param filename Името на файла, който предстои да бъде презаписан.
 * @return true, ако потребителят потвърди презаписването, в противен случай false.
 *
 * Това предотвратява случайна загуба на данни, когато операциите по запис могат да заменят съществуващи файлове.
 */
bool confirmOverwrite(const char* filename);

/**
 * @brief Синхронизира данните за имоти с файловете за възстановяване (както двоични, така и текстови).
 * @param properties Постоянен масив от структури Property за синхронизация.
 * @param propertyCount Броят на имотите в масива.
 *
 * Тази функция гарантира, че резервните файлове и файловете за синхронизация са актуални
 * с текущото състояние на данните за имоти, осигурявайки множество слоеве за безопасност на данните.
 */
void syncDataToRecoveryFiles(const Property properties[], int propertyCount);

#endif
